#!/bin/bash

ARCH="$(uname -m)"
PACKAGE="$1"
PACKAGEDIR="pkgs/$ARCH/$PACKAGE"
CACHEDIR="cache"

prepare_cache() {
    mkdir -p "$CACHEDIR"
    rm -rf "$CACHEDIR/$PACKAGE"
    cp -r "$PACKAGEDIR" "$CACHEDIR"
}

if [[ ! -z "$PACKAGE" ]]; then

    if [[ -d "$PACKAGEDIR" ]]; then
        echo -e "Found package $PACKAGEDIR\nTo begin install press ENTER..."
        read

        prepare_cache
        cd "$CACHEDIR/$PACKAGE"
        makepkg -sif
    else
        echo "ERROR: Could not find package $PACKAGEDIR"
    fi

else
    echo "ERROR: You must specify a package to install!"
    echo "Example:"
    echo "  $0 neopo"
fi